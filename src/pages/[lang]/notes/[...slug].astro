---
import { type CollectionEntry, getCollection, render } from "astro:content"
import Layout from "../../../layouts/Layout.astro"

export async function getStaticPaths() {
  const pages = await getCollection("notes")

  return pages.map((page: CollectionEntry<"notes">) => {
    const [lang, ...slug] = page.id
      .replace(/\.[^/.]+$/, "") // 拡張子 (.mdx) を消す
      .split("/")
    const path = {
      params: { lang, slug: slug.join("/") || undefined },
      props: { page },
    }
    return path
  })
}

interface Props {
  page: CollectionEntry<"notes">
}

const { page } = Astro.props
const { Content } = await render(page)
---

<Layout title={page.data.title}>
  <Content />
</Layout>
